<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>lemueIO SecMonitor</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="/assets/hfish-ui.1.2.12.css" />
  <style type="text/css">
    .main-loading-wrap {
      text-align: center;
      margin-top: 100px;
      color: rgba(17, 18, 34, 0.6);
      font-size: 12px;
    }

    .lds-dual-ring {
      display: inline-block;
      width: 30px;
      height: 30px;
      margin-bottom: 10px;
    }

    .lds-dual-ring:after {
      content: " ";
      display: block;
      width: 24px;
      height: 24px;
      margin: 8px;
      border-radius: 50%;
      border: 2px solid rgba(17, 18, 34, 0.8);
      border-color: rgba(17, 18, 34, 0.8) transparent rgba(17, 18, 34, 0.8) transparent;
      animation: lds-dual-ring 1.2s linear infinite;
      animation: lds-dual-ring 1.2s linear infinite;
    }

    @keyframes lds-dual-ring {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
  <!-- <link rel="stylesheet" href="/styles/index.css"> -->
  <script type="text/javascript">
    if (!('remove' in Element.prototype)) {
      Element.prototype.remove = function () {
        if (this.parentNode) {
          this.parentNode.removeChild(this);
        }
      };
    }

    // PERMANENT BRANDING & ASSET FIX
    const BRAND_TITLE = "lemueIO SecMonitor";
    const OLD_TITLE_TEXT = "XX Company Threat Monitor";

    // 1. Force Document Title (Aggressive)
    const forceTitle = () => {
      if (document.title !== BRAND_TITLE) {
        document.title = BRAND_TITLE;
      }
    };
    forceTitle();
    // Observer
    new MutationObserver(forceTitle).observe(document.querySelector('title'), { subtree: true, characterData: true, childList: true });
    // Interval fallback
    setInterval(forceTitle, 500);

    // 2. Inject Flag Icons (Fixes '?' issue)
    fetch('/assets/flags.svg')
      .then(r => r.text())
      .then(svgContent => {
        const div = document.createElement('div');
        div.style.display = 'none';
        div.innerHTML = svgContent;

        // Rewrite IDs to match HFish
        const symbols = div.querySelectorAll('symbol');
        symbols.forEach(sym => {
          const countryCode = sym.id.replace('flag-', '');
          const newId = 'icon-' + countryCode;
          // Avoid duplicate IDs if multiple scripts run
          if (!document.getElementById(newId)) {
            const clone = sym.cloneNode(true);
            clone.id = newId;
            div.querySelector('svg').appendChild(clone);
          }
        });
        document.body.insertBefore(div, document.body.firstChild);
      }).catch(e => console.error("Flag injection failed", e));

    // 3. Map Location Fix (DISABLED - Causing hanging issues)
    /*
    const ORIGINAL_JSON = Response.prototype.json;
    Response.prototype.json = async function () {
      const data = await ORIGINAL_JSON.call(this);
      try {
        const fixCoords = (obj) => {
          if (!obj || typeof obj !== 'object') return;

          // Detection heuristic for the node
          const isBuiltIn = (obj.node_name && obj.node_name.includes("Built-in")) ||
            (obj.name && obj.name.includes("Built-in"));

          if (isBuiltIn) {
            // Update to Falkenstein, Sachsen (50.47788, 12.37311)
            // ECharts typically uses [lon, lat] for 'value' or 'coord'
            const FALKENSTEIN = [12.37311, 50.47788];

            if (Array.isArray(obj.value) && obj.value.length >= 2) {
              // Preserve other values (like count), only update coords
              obj.value[0] = FALKENSTEIN[0];
              obj.value[1] = FALKENSTEIN[1];
            }
            if (Array.isArray(obj.coord)) {
              obj.coord = FALKENSTEIN;
            }
          }
          Object.values(obj).forEach(fixCoords);
        };
        fixCoords(data);
      } catch (e) {
        // fail silently to not break app
      }
      return data;
    };
    */


    // 4. Text Replacement (Aggressive) & CSS Injection
    const style = document.createElement('style');
    style.innerHTML = `
      .screen-header-left-title, .screen-title { 
          visibility: hidden !important; 
          position: relative !important;
      }
      .screen-header-left-title::after, .screen-title::after {
          visibility: visible !important;
          content: "${BRAND_TITLE}" !important;
          position: absolute !important;
          left: 0 !important;
          top: 0 !important;
          color: #fff !important; 
      }
    `;
    document.head.appendChild(style);

    const replaceBranding = () => {
      const treeWalker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);
      while (treeWalker.nextNode()) {
        const node = treeWalker.currentNode;
        if (node.nodeValue.includes(OLD_TITLE_TEXT)) {
          node.nodeValue = node.nodeValue.replace(OLD_TITLE_TEXT, BRAND_TITLE);
        }
        if (node.nodeValue.includes("HFish")) {
          node.nodeValue = node.nodeValue.replace("HFish", "lemueIO SecMonitor");
        }
      }
    };

    setInterval(replaceBranding, 100); 
  </script>
  <link rel="shortcut icon" href="/assets/favicon.ico">
</head>

<body>
  <div id="app">
    <div class="main-loading-wrap">
      <div class="spinner-wrapper">
        <div class="lds-dual-ring"></div>
        <div class="spinner-txt">加载中...</div>
      </div>
    </div>
  </div>
  <script>
    __REACT_DEVTOOLS_GLOBAL_HOOK__ = parent.__REACT_DEVTOOLS_GLOBAL_HOOK__;
  </script>
  <script type="text/javascript" defer src="/assets/flags/svgxuse.min.js"></script>
  <script type="text/javascript" src="/assets/dllSelf.09a1636445d39f4f9ec3.js"></script>
  <script type="text/javascript" src="/assets/app.6539b5af.js"></script>
</body>

</html>