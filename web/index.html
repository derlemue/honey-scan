<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>lemueIO SecMonitor</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="/assets/hfish-ui.1.2.12.css" />
    <style type="text/css">
        /* HIDE SCROLLBARS GLOBALLY */
        ::-webkit-scrollbar {
            display: none !important;
            width: 0 !important;
            height: 0 !important;
        }

        * {
            scrollbar-width: none !important;
            -ms-overflow-style: none !important;
        }

        .main-loading-wrap {
            text-align: center;

            margin-top: 100px;
            color: rgba(17, 18, 34, 0.6);
            font-size: 12px;
        }

        .lds-dual-ring {
            display: inline-block;
            width: 30px;
            height: 30px;
            margin-bottom: 10px;
        }

        .lds-dual-ring:after {
            content: " ";
            display: block;
            width: 24px;
            height: 24px;
            margin: 8px;
            border-radius: 50%;
            border: 2px solid rgba(17, 18, 34, 0.8);
            border-color: rgba(17, 18, 34, 0.8) transparent rgba(17, 18, 34, 0.8) transparent;
            animation: lds-dual-ring 1.2s linear infinite;
            animation: lds-dual-ring 1.2s linear infinite;
        }

        @keyframes lds-dual-ring {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
    <!-- <link rel="stylesheet" href="/styles/index.css"> -->
    <script type="text/javascript">
        if (!('remove' in Element.prototype)) {
            Element.prototype.remove = function () {
                if (this.parentNode) {
                    this.parentNode.removeChild(this);
                }
            };
        }
    </script>
    <link rel="shortcut icon" href="/assets/favicon.ico">
    <script>
        // [FOUC FIX] Immediate Styling for Login Page
        // This runs before body renders to prevent the "Red Flash"
        (function () {
            const isLogin = location.href.includes('/login') || location.hash.includes('login');
            if (isLogin) {
                const style = document.createElement('style');
                style.id = 'branding-style';
                style.innerHTML = `html, body { background-color: #0f172a !important; margin: 0 !important; padding: 0 !important; overflow-x: hidden !important; } div[class*="header"], header, .el-header, .header-wrapper, nav, section[class*="header"], .screen-header-left-title, .screen-title, div[class*="top"], .el-card__header { display: none !important; opacity: 0 !important; visibility: hidden !important; height: 0 !important; width: 0 !important; padding: 0 !important; margin: 0 !important; border: none !important; overflow: hidden !important; } div[class*="header"] * { display: none !important; } div[class*="index-cssmodule__login-wrapper"], .login-container, .login-box { margin-top: 10px !important; } div[class*="index-cssmodule__btn"], button[class*="index-cssmodule__btn"], .el-button--primary { background-color: #4ade80 !important; border-color: #4ade80 !important; color: #0f172a !important; font-weight: bold !important; } div[class*="index-cssmodule__btn"]:hover, button[class*="index-cssmodule__btn"]:hover, .el-button--primary:hover { background-color: #22c55e !important; border-color: #22c55e !important; } .index-cssmodule__ipv6-1nOCE { background-color: #4ade80 !important; color: #ffffff !important; font-weight: bold !important; border-color: #4ade80 !important; border: 1px solid #4ade80 !important; } img[src*="logo_bear.png"] { width: 80% !important; max-width: 350px !important; display: block; margin: 0 auto; padding: 15px !important; box-sizing: border-box !important; aspect-ratio: 1 / 1 !important; object-fit: contain !important; height: auto !important; } #lemue-footer { position: fixed; bottom: 10px; width: 100%; text-align: center; color: rgba(255, 255, 255, 0.5); font-size: 12px; pointer-events: none; z-index: 9999; } #lemue-link-bar { position: fixed; top: 0; right: 0; display: flex; gap: 15px; z-index: 10000; background: rgba(0, 0, 0, 0.4); padding: 8px 20px; border-bottom-left-radius: 15px; backdrop-filter: blur(5px); } .lemue-link { display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; opacity: 0.7; transition: opacity 0.2s; color: #4ade80; } .lemue-link:hover { opacity: 1; transform: scale(1.1); } .lemue-link svg { width: 100%; height: 100%; fill: currentColor; } .lemue-link img { width: 100%; height: 100%; border-radius: 50%; }`;
                document.head.appendChild(style);
            }
        })();
    </script>
</head>

<body>
    <!-- INJECTED FLAG DEFINITIONS -->
    <!-- Flags are now loaded from /assets/symbol-defs.svg -->

    <div id="app">
        <div class="main-loading-wrap">
            <div class="spinner-wrapper">
                <div class="lds-dual-ring"></div>
                <div class="spinner-txt">Loading...</div>
            </div>
        </div>
    </div>
    <script>
        __REACT_DEVTOOLS_GLOBAL_HOOK__ = parent.__REACT_DEVTOOLS_GLOBAL_HOOK__;
    </script>
    <script type="text/javascript" defer src="/assets/flags/svgxuse.min.js"></script>
    <script type="text/javascript" src="/assets/dllSelf.09a1636445d39f4f9ec3.js"></script>
    <script type="text/javascript" src="/assets/app.6539b5af.js"></script>
    <script src="/assets/country_map.js"></script>
    <script>
        // Branding Configuration
        console.log("[HoneyScan] Patch Script v2.3 Loaded (No Interceptor)");
        const BRAND_TITLE = "Honey Scan Active Defense";
        const LOGO_PATH = '/assets/logo_bear.png';

        const patchBrandingAggressive = () => {
            if (document.title !== "lemueIO SecMonitor") {
                document.title = "lemueIO SecMonitor";
            }

            // === UNIVERSAL TEXT REPLACEMENT ===
            const replaceTextContent = (selector, target, replacement) => {
                try {
                    const elements = document.querySelectorAll(selector);
                    elements.forEach(el => {
                        if (!el.innerText) return;
                        if (el.children.length === 0 && el.innerText.includes(target) && !el.dataset.branded) {
                            el.innerText = el.innerText.replace(target, replacement);
                            el.dataset.branded = 'true';
                        }
                    });
                } catch (e) { }
            };
            const textTags = 'div, span, h1, h2, h3, h4, h5, p, li, a, td, th';
            replaceTextContent(textTags, 'XX Company Threat Monitor', 'lemueIO SecMonitor');
            replaceTextContent(textTags, 'HFish Attack Map', 'lemueIO SecMonitor');
            replaceTextContent(textTags, 'HFish Statistics', 'lemueIO Statistics');
            replaceTextContent(textTags, 'Live Threat Monitor', 'lemueIO Active Intelligence Feed');

            // Login Page Logic
            const isLogin = location.href.includes('/login') || location.hash.includes('login');
            if (isLogin) {
                // Remove original header elements more aggressively
                if (!document.getElementById('branding-style')) {
                    const style = document.createElement('style');
                    style.id = 'branding-style';
                    style.innerHTML = `html, body { background-color: #0f172a !important; margin: 0 !important; padding: 0 !important; overflow-x: hidden !important; } div[class*="header"], header, .el-header, .header-wrapper, nav, section[class*="header"], .screen-header-left-title, .screen-title, div[class*="top"], .el-card__header { display: none !important; opacity: 0 !important; visibility: hidden !important; height: 0 !important; width: 0 !important; padding: 0 !important; margin: 0 !important; border: none !important; overflow: hidden !important; } div[class*="header"] * { display: none !important; } div[class*="index-cssmodule__login-wrapper"], .login-container, .login-box { margin-top: 10px !important; } div[class*="index-cssmodule__btn"], button[class*="index-cssmodule__btn"], .el-button--primary { background-color: #4ade80 !important; border-color: #4ade80 !important; color: #0f172a !important; font-weight: bold !important; } div[class*="index-cssmodule__btn"]:hover, button[class*="index-cssmodule__btn"]:hover, .el-button--primary:hover { background-color: #22c55e !important; border-color: #22c55e !important; } .index-cssmodule__ipv6-1nOCE { background-color: #4ade80 !important; color: #ffffff !important; font-weight: bold !important; border-color: #4ade80 !important; border: 1px solid #4ade80 !important; } img[src*="logo_bear.png"] { width: 80% !important; max-width: 350px !important; display: block; margin: 0 auto; padding: 15px !important; box-sizing: border-box !important; aspect-ratio: 1 / 1 !important; object-fit: contain !important; height: auto !important; } #lemue-footer { position: fixed; bottom: 10px; width: 100%; text-align: center; color: rgba(255, 255, 255, 0.5); font-size: 12px; pointer-events: none; z-index: 9999; } #lemue-link-bar { position: fixed; top: 0; right: 0; display: flex; gap: 15px; z-index: 10000; background: rgba(0, 0, 0, 0.4); padding: 8px 20px; border-bottom-left-radius: 15px; backdrop-filter: blur(5px); } .lemue-link { display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; opacity: 0.7; transition: opacity 0.2s; color: #4ade80; } .lemue-link:hover { opacity: 1; transform: scale(1.1); } .lemue-link svg { width: 100%; height: 100%; fill: currentColor; } .lemue-link img { width: 100%; height: 100%; border-radius: 50%; }`;
                    document.head.appendChild(style);
                }
                const leftWrapper = document.querySelector('div[class*="left-wrapper"]');
                if (leftWrapper) {
                    const svgs = leftWrapper.querySelectorAll('svg');
                    svgs.forEach(svg => {
                        if (svg.innerHTML.includes('#hfish') || svg.innerHTML.includes('hfish')) {
                            const container = svg.parentElement;
                            if (container && !container.dataset.patched && !container.querySelector('input')) {
                                container.innerHTML = '';
                                const newLogo = document.createElement('img');
                                newLogo.src = LOGO_PATH;
                                newLogo.style.maxWidth = '100%';
                                newLogo.style.height = 'auto';
                                container.appendChild(newLogo);
                                container.dataset.patched = 'true';
                            }
                        }
                    });
                }
                const rightWrapper = document.querySelector('div[class*="right-wrapper"]');
                if (rightWrapper) {
                    const brandSvgs = rightWrapper.querySelectorAll('svg');
                    brandSvgs.forEach(svg => {
                        if (svg.innerHTML.includes('hfish') || svg.getAttribute('class')?.includes('onefish-logo')) {
                            if (!svg.dataset.patched) {
                                const container = document.createElement('div');
                                container.style.textAlign = 'center';
                                container.style.marginBottom = '20px';
                                container.style.display = 'flex';
                                container.style.flexDirection = 'column';
                                container.style.alignItems = 'center';
                                container.style.justifyContent = 'center';
                                const title = document.createElement('div');
                                title.innerText = "Honey Scan";
                                title.style.color = "#4ade80";
                                title.style.fontSize = "36px";
                                title.style.fontWeight = "900";
                                title.style.fontFamily = "sans-serif";
                                title.style.letterSpacing = "1px";
                                title.style.marginBottom = "8px";
                                title.style.lineHeight = "1.2";
                                const pill = document.createElement('div');
                                pill.innerText = "Active Defense Platform";
                                pill.style.backgroundColor = "rgba(255, 255, 255, 0.1)";
                                pill.style.color = "rgba(255, 255, 255, 0.8)";
                                pill.style.padding = "4px 12px";
                                pill.style.borderRadius = "12px";
                                pill.style.fontSize = "14px";
                                pill.style.fontWeight = "500";
                                pill.style.display = "inline-block";
                                container.appendChild(title);
                                container.appendChild(pill);
                                svg.replaceWith(container);
                                container.dataset.patched = 'true';
                            }
                        }
                    });
                }
                if (!document.getElementById('lemue-footer')) {
                    const footer = document.createElement('div');
                    footer.id = 'lemue-footer';
                    footer.innerHTML = 'for you by lemue.org ♥️';
                    document.body.appendChild(footer);
                }
                if (!document.getElementById('lemue-link-bar')) {
                    const linkBar = document.createElement('div');
                    linkBar.id = 'lemue-link-bar';
                    const links = [
                        { href: 'https://github.com/derlemue/honey-scan', icon: '<svg viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>', title: 'GitHub' },
                        { href: 'https://feed.sec.lemue.org/', icon: '<svg viewBox="0 0 24 24"><path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/></svg>', title: 'Feed' },
                        { href: 'https://feed.sec.lemue.org/feed/banned_ips.txt', icon: '<svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>', title: 'Banned IPs' },
                        { href: 'https://lemue.org', icon: '<img src="https://lemue.org/favicon.ico" alt="lemue.org" onerror="this.style.display=\'none\'">', title: 'lemue.org' }
                    ];
                    links.forEach(link => { const a = document.createElement('a'); a.href = link.href; a.className = 'lemue-link'; a.target = '_blank'; a.innerHTML = link.icon; a.title = link.title; linkBar.appendChild(a); });
                    document.body.appendChild(linkBar);
                }
            } else {
                const style = document.getElementById('branding-style'); if (style) style.remove();
                const linkBar = document.getElementById('lemue-link-bar'); if (linkBar) linkBar.remove();
                const footer = document.getElementById('lemue-footer'); if (footer) footer.remove();
            }
            const addFavicon = (rel, href, sizes) => { if (!document.querySelector(`link[href="${href}"]`)) { let link = document.createElement('link'); link.rel = rel; link.href = href; if (sizes) link.sizes = sizes; document.head.appendChild(link); } };
            if (!window.faviconsPatched) { document.querySelectorAll('link[rel="shortcut icon"]').forEach(e => e.remove()); window.faviconsPatched = true; }
            addFavicon('icon', '/assets/favicon.ico'); addFavicon('icon', '/assets/favicon-32x32.png', '32x32'); addFavicon('icon', '/assets/favicon-16x16.png', '16x16'); addFavicon('apple-touch-icon', '/assets/apple-touch-icon.png');
        };

        const patchDataIssues = () => {
            try {
                // Timezone
                const timeElements = document.querySelectorAll('p[class*="time"], span[class*="time"]');
                timeElements.forEach(el => {
                    if (el.dataset.timePatched) return;
                    const text = el.innerText.trim();
                    if (/^\d{4}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/.test(text)) {
                        const dateStr = text.replace(/\//g, '-');
                        let date = new Date(dateStr);
                        if (!isNaN(date.getTime())) {
                            date.setTime(date.getTime() + 3600000);
                            const pad = (n) => n.toString().padStart(2, '0');
                            el.innerText = `${date.getFullYear()}/${pad(date.getMonth() + 1)}/${pad(date.getDate())} ${pad(date.getHours())}:${pad(date.getMinutes())}:${pad(date.getSeconds())}`;
                            el.dataset.timePatched = 'true';
                        }
                    }
                });
                // Flags in Recent Attacks Table (using old hfish-flag IDs)
                const flagSvgs = document.querySelectorAll('svg.flag-icon');
                flagSvgs.forEach(svg => {
                    const useHref = svg.querySelector('use');
                    if (!useHref) return; // Wait for use element
                    const href = useHref.getAttribute('xlink:href') || useHref.getAttribute('href');

                    const countrySpan = svg.nextElementSibling;
                    if (!countrySpan || countrySpan.tagName !== 'SPAN') return;
                    const country = countrySpan.innerText.trim();

                    // Use Global Map
                    let code = null;
                    if (window.COUNTRY_MAP && window.COUNTRY_MAP[country]) {
                        code = window.COUNTRY_MAP[country];
                    } else if (window.COUNTRY_MAP) {
                        // Fallback case-insensitive
                        const found = Object.keys(window.COUNTRY_MAP).find(k => k.toLowerCase() === country.toLowerCase());
                        if (found) code = window.COUNTRY_MAP[found];
                    }

                    if (code) {
                        const expectedHref = `/assets/symbol-defs.svg#icon-${code}`;
                        // Only update if not already correct
                        if (!href || !href.includes(expectedHref)) {
                            useHref.setAttribute('xlink:href', expectedHref);
                            useHref.setAttribute('href', expectedHref);
                            svg.classList.remove('undefined');
                            svg.classList.add(`flag-icon-${code}`);
                            svg.dataset.flagPatched = 'true';
                        }
                    }
                });

                // Ticker (Bottom Carousel)
                const tickerSvgs = document.querySelectorAll('svg.flag-icon-margin');
                tickerSvgs.forEach(svg => {
                    const use = svg.querySelector('use');
                    if (!use) return;

                    const href = use.getAttribute('xlink:href') || use.getAttribute('href');

                    if (href && (href.includes('flag') || href.includes('icon-') || href.includes('default'))) {
                        // Remove the monochromatic fill ONLY for flags
                        if (svg.getAttribute('fill')) svg.removeAttribute('fill');
                        if (svg.style.fill) svg.style.fill = '';

                        // Fix Broken Defaults or incomplete flags in Ticker
                        if (href.includes('flagdefault') || href.includes('symbol-defs')) {
                            const box = svg.closest('.ant-carousel-item') || svg.closest('div[style*="background"]');
                            if (box) {
                                const text = box.innerText;
                                // Attempt to extract country name from text "Attack Source: Germany" or similar?
                                // Usually ticker text is "IP Location" or just "Germany"
                                // We check against all keys in COUNTRY_MAP. This might be slow but robust.
                                // Optimization: Common countries first?

                                let country = null;
                                if (window.COUNTRY_MAP) {
                                    // Try to find a country name in the text
                                    // Sort by length desc to match "United States" before "States" etc.
                                    const names = Object.keys(window.COUNTRY_MAP).sort((a, b) => b.length - a.length);
                                    country = names.find(c => text.includes(c));
                                }

                                if (country) {
                                    const code = window.COUNTRY_MAP[country];
                                    const newHref = `/assets/symbol-defs.svg#icon-${code}`;

                                    // Update if different
                                    if (href !== newHref) {
                                        use.setAttribute('xlink:href', newHref);
                                        use.setAttribute('href', newHref);
                                        svg.classList.remove('undefined');
                                        svg.style.display = 'inline-block';
                                        if (!svg.getAttribute('width')) svg.setAttribute('width', '24');
                                        if (!svg.getAttribute('height')) svg.setAttribute('height', '18');
                                    }
                                }
                            }
                        }
                    }
                });
            } catch (e) { console.error('Data patch error:', e); }
        };


        // === REAL-TIME THREAT FEED (VIA JSON) ===
        const FEED_URL = 'assets/live_threats.json';

        // State Management
        let feedState = {
            hackers: [],
            cs: [],
            api_active: false
        };

        // Fetch Data
        const updateFeeds = async () => {
            try {
                const response = await fetch(FEED_URL + '?t=' + new Date().getTime());
                if (response.ok) {
                    const data = await response.json();

                    if (data.hackers) feedState.hackers = data.hackers;
                    if (data.cs) feedState.cs = data.cs;
                    feedState.api_active = data.api_active;

                    renderFeeds();
                }
            } catch (e) {
                // Silent fail
            }
        };

        // Update DOM
        const renderFeeds = () => {
            try {
                // Find Headers (Standard vs Fallback)
                let hackersHeader = null;
                let csHeader = null;

                const headers = Array.from(document.querySelectorAll('div, span, p, h3'));
                hackersHeader = headers.find(h => h.innerText && h.innerText.trim() === 'Recent active hackers');
                csHeader = headers.find(h => h.innerText && h.innerText.trim() === 'The recent suspicious CS');

                // FALLBACK: If standard headers are missing, inject our own container
                if (!hackersHeader && !csHeader) {
                    const rightWrapper = document.querySelector('div[class*="right-wrapper"]');
                    if (rightWrapper) {
                        let lemueContainer = document.getElementById('lemue-intelligence-container');
                        if (!lemueContainer) {
                            lemueContainer = document.createElement('div');
                            lemueContainer.id = 'lemue-intelligence-container';
                            lemueContainer.style.marginBottom = '20px';
                            lemueContainer.style.padding = '0 10px';
                            // Insert at top
                            rightWrapper.insertBefore(lemueContainer, rightWrapper.firstChild);

                            // Create Mock Headers
                            const h1 = document.createElement('div');
                            h1.innerText = 'Recent active hackers';
                            h1.style.color = '#fff'; h1.style.fontSize = '14px'; h1.style.fontWeight = 'bold';
                            h1.style.marginBottom = '10px'; h1.style.marginTop = '10px';
                            lemueContainer.appendChild(h1);
                            hackersHeader = h1;

                            const h2 = document.createElement('div');
                            h2.innerText = 'The recent suspicious CS';
                            h2.style.color = '#fff'; h2.style.fontSize = '14px'; h2.style.fontWeight = 'bold';
                            h2.style.marginBottom = '10px'; h2.style.marginTop = '20px';
                            lemueContainer.appendChild(h2);
                            csHeader = h2;
                        } else {
                            hackersHeader = Array.from(lemueContainer.children).find(el => el.innerText === 'Recent active hackers');
                            csHeader = Array.from(lemueContainer.children).find(el => el.innerText === 'The recent suspicious CS');
                        }
                    }
                }

                // 1. Render "Recent active hackers" (Top Box)
                if (hackersHeader) {
                    let container = hackersHeader.parentElement.querySelector('.dynamic-hacker-list');
                    if (!container) {
                        if (hackersHeader.parentElement.id !== 'lemue-intelligence-container') {
                            const parent = hackersHeader.parentElement;
                            Array.from(parent.children).forEach(child => {
                                if (child !== hackersHeader && !child.classList.contains('active-defense-title')) {
                                    child.style.display = 'none'; // Hide original React lists
                                }
                            });
                        }

                        container = document.createElement('div');
                        container.className = 'dynamic-hacker-list';
                        container.style.height = '240px';
                        container.style.overflow = 'hidden';
                        container.style.marginTop = '10px';
                        container.style.marginBottom = '20px';
                        container.style.display = 'flex';
                        container.style.flexDirection = 'column';
                        container.style.gap = '6px';
                        hackersHeader.parentElement.appendChild(container);
                    }

                    let html = '';
                    feedState.hackers.forEach((item, idx) => {
                        let flagCode = 'unknown';
                        if (item.flag && item.flag.length === 2) flagCode = item.flag.toLowerCase();
                        else if (item.location) {
                            const loc = item.location;
                            if (window.COUNTRY_MAP) {
                                if (window.COUNTRY_MAP[loc]) flagCode = window.COUNTRY_MAP[loc];
                                else {
                                    const found = Object.keys(window.COUNTRY_MAP).find(k => k.toLowerCase() === loc.toLowerCase() || loc.includes(k));
                                    if (found) flagCode = window.COUNTRY_MAP[found];
                                }
                            }
                        }

                        html += `
                            <div style="display: flex; align-items: center; padding: 6px 12px; background: rgba(255, 255, 255, 0.03); border-radius: 4px;">
                                <div style="width: 24px; margin-right: 10px; display: flex; align-items: center;">
                                    <svg viewBox="0 0 24 24" width="20" height="15" style="display:inline-block; vertical-align:middle;">
                                        <use href="/assets/symbol-defs.svg#icon-${flagCode}"></use>
                                    </svg>
                                </div>
                                <div style="flex: 1;">
                                    <div style="color: #94a3b8; font-size: 11px; margin-bottom: 2px;">${item.location}</div>
                                    <div style="color: #e2e8f0; font-family: monospace; font-size: 13px;">${item.ip}</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: #fca5a5; font-size: 11px;">SSH Brute</div> 
                                    <div style="color: #4ade80; font-size: 10px; font-weight: bold;">${item.count || 1} hits</div>
                                </div>
                            </div>
                        `;
                    });

                    if (feedState.hackers.length === 0) {
                        html = '<div style="color: #64748b; padding: 20px; text-align: center;">Waiting for incoming threats...</div>';
                    }
                    container.innerHTML = html;
                }

                // 2. Render "The recent suspicious CS" (Bottom Box)
                if (csHeader) {
                    let container = csHeader.parentElement.querySelector('.dynamic-cs-list');
                    if (!container) {
                        if (csHeader.parentElement.id !== 'lemue-intelligence-container') {
                            const parent = csHeader.parentElement;
                            Array.from(parent.children).forEach(child => {
                                if (child !== csHeader) child.style.display = 'none';
                            });
                        }

                        container = document.createElement('div');
                        container.className = 'dynamic-cs-list';
                        container.style.marginTop = '15px';
                        container.style.display = 'flex';
                        container.style.flexDirection = 'column';
                        container.style.gap = '8px';
                        csHeader.parentElement.appendChild(container);
                    }

                    let html = '';
                    feedState.cs.forEach(item => {
                        const risk = item.risk || 'Low';
                        let color = '#eca913';
                        if (risk === 'Critical') color = '#ef4444';
                        if (risk === 'High') color = '#f97316';

                        html += `
                            <div style="display: flex; align-items: center; background: rgba(30, 41, 59, 0.5); padding: 8px 10px; border-radius: 4px; border-left: 3px solid ${color}; margin-bottom: 4px;">
                                <div style="margin-right: 12px; display: flex; align-items: center; justify-content: center; width: 32px; height: 32px; background: rgba(255,255,255,0.05); border-radius: 50%;">
                                    <svg viewBox="0 0 24 24" width="18" height="18" fill="${color}"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                                </div>
                                <div style="flex: 1;">
                                    <div style="color: #f1f5f9; font-size: 13px; font-weight: bold; font-family: monospace; letter-spacing: 0.5px;">${item.ip}</div>
                                    <div style="color: #94a3b8; font-size: 11px; display: flex; align-items: center; gap: 6px; margin-top: 2px;">
                                        <span style="background:rgba(255,255,255,0.1); padding: 1px 4px; border-radius: 2px;">${item.location}</span>
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="color: ${color}; font-size: 11px; font-weight: 700; text-transform: uppercase;">${item.type}</div>
                                    <div style="color: #64748b; font-size: 10px; margin-top: 2px;">Risk: ${risk}</div>
                                </div>
                            </div>
                        `;
                    });

                    if (feedState.cs.length === 0) {
                        html = '<div style="color: #64748b; padding: 20px; text-align: center;">Scanning...</div>';
                    }
                    container.innerHTML = html;
                }

            } catch (e) { console.error("Feed Render Error:", e); }
        };

        // Initialize and Loop
        updateFeeds();

        setInterval(() => {
            updateFeeds();
            renderFeeds();

            patchBrandingAggressive();
            patchDataIssues();
        }, 5000);

    </script>
</body>

</html>